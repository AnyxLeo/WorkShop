{"id":"iBp1","dependencies":[{"name":"C:\\Users\\Anyx\\Documents\\Unosquare\\Tubular\\Tubular.Web\\client-app\\package.json","includedInParent":true,"mtime":1567469419529},{"name":"C:\\Users\\Anyx\\Documents\\Unosquare\\Tubular\\Tubular.Web\\client-app\\node_modules\\tubular-common\\package.json","includedInParent":true,"mtime":1567480635442},{"name":"./date-utils","loc":{"line":3,"column":27},"parent":"C:\\Users\\Anyx\\Documents\\Unosquare\\Tubular\\Tubular.Web\\client-app\\node_modules\\tubular-common\\dist\\Transformer.js","resolved":"C:\\Users\\Anyx\\Documents\\Unosquare\\Tubular\\Tubular.Web\\client-app\\node_modules\\tubular-common\\dist\\date-utils.js"},{"name":"./Models","loc":{"line":4,"column":23},"parent":"C:\\Users\\Anyx\\Documents\\Unosquare\\Tubular\\Tubular.Web\\client-app\\node_modules\\tubular-common\\dist\\Transformer.js","resolved":"C:\\Users\\Anyx\\Documents\\Unosquare\\Tubular\\Tubular.Web\\client-app\\node_modules\\tubular-common\\dist\\Models\\index.js"},{"name":"./Models/GridResponse","loc":{"line":5,"column":29},"parent":"C:\\Users\\Anyx\\Documents\\Unosquare\\Tubular\\Tubular.Web\\client-app\\node_modules\\tubular-common\\dist\\Transformer.js","resolved":"C:\\Users\\Anyx\\Documents\\Unosquare\\Tubular\\Tubular.Web\\client-app\\node_modules\\tubular-common\\dist\\Models\\GridResponse.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var e=require(\"./date-utils\"),r=require(\"./Models\"),t=require(\"./Models/GridResponse\"),a=function(r,t){return e.default(r).getTime()===e.default(t).getTime()},n=function(r,t){return e.default(r).getTime()>e.default(t).getTime()},o=function(r,t){return e.default(r).getTime()<e.default(t).getTime()},i=function(){function e(){}return e.getResponse=function(e,r){var a=this,n=new t.default(e.Counter);n.TotalRecordCount=r.length;var o=this.applyFreeTextSearch(e,r);return o=this.applyFiltering(e,o),o=this.applySorting(e,o),n.FilteredRecordCount=o.length,e.Take>-1&&(n.TotalPages=Math.ceil(n.FilteredRecordCount/e.Take),n.TotalPages>0&&(n.CurrentPage=e.Skip/e.Take+1)),n.AggregationPayload=this.getAggregatePayload(e,o),n.Payload=o.slice(e.Skip,e.Skip+e.Take).map(function(r){return a.parsePayload(r,e.Columns)}),n},e.applyFreeTextSearch=function(e,t){if(e.Search&&e.Search.Operator.toLowerCase()===r.CompareOperators.AUTO.toLowerCase()){var a=e.Columns.filter(function(e){return e.Searchable});if(a.length>0){var n=e.Search.Text.toLowerCase();return\"\"===n?t:t.filter(function(e){return a.some(function(r){return void 0!==e[r.Name]&&e[r.Name].toLowerCase().indexOf(n)>-1})})}return t}},e.applyFiltering=function(e,t){return e.Columns.filter(function(e){return e.hasFilter}).forEach(function(e){var i=\"datetime\"===e.DataType||\"date\"===e.DataType||\"datetimeutc\"===e.DataType,u=function(r,t){return r.filter(function(r){return void 0!==r[e.Name]&&null!==r[e.Name]&&t(r[e.Name])})};switch(e.Filter.Operator){case r.CompareOperators.EQUALS:t=i?t.filter(function(r){return a(r[e.Name],e.Filter.Text)}):\"string\"===e.DataType?u(t,function(r){return r.toLowerCase()===e.Filter.Text.toLowerCase()}):t.filter(function(r){return r[e.Name]===e.Filter.Text});break;case r.CompareOperators.NOT_EQUALS:t=\"string\"===e.DataType?u(t,function(r){return r.toLowerCase()!==e.Filter.Text.toLowerCase()}):t.filter(function(r){return r[e.Name]!==e.Filter.Text});break;case r.CompareOperators.CONTAINS:t=u(t,function(r){return r.toLowerCase().indexOf(e.Filter.Text.toLowerCase())>=0}),t=u(t,function(r){return r.toLowerCase().indexOf(e.Filter.Text.toLowerCase())>=0});break;case r.CompareOperators.NOT_CONTAINS:t=u(t,function(r){return r.toLowerCase().indexOf(e.Filter.Text.toLowerCase())<0});break;case r.CompareOperators.STARTS_WITH:t=u(t,function(r){return r.toLowerCase().startsWith(e.Filter.Text.toLowerCase())});break;case r.CompareOperators.NOT_STARTS_WITH:t=u(t,function(r){return!r.toLowerCase().startsWith(e.Filter.Text.toLowerCase())});break;case r.CompareOperators.ENDS_WITH:t=u(t,function(r){return r.toLowerCase().endsWith(e.Filter.Text.toLowerCase())});case r.CompareOperators.NOT_ENDS_WITH:t=u(t,function(r){return!r.toLowerCase().endsWith(e.Filter.Text.toLowerCase())});break;case r.CompareOperators.GT:t=i?t.filter(function(r){return n(r[e.Name],e.Filter.Text)}):t.filter(function(r){return r[e.Name]>e.Filter.Text});break;case r.CompareOperators.GTE:t=i?t.filter(function(r){return a(r[e.Name],e.Filter.Text)||n(r[e.Name],e.Filter.Text)}):t.filter(function(r){return r[e.Name]>=e.Filter.Text});break;case r.CompareOperators.LT:t=i?t.filter(function(r){return o(r[e.Name],e.Filter.Text)}):t.filter(function(r){return r[e.Name]<e.Filter.Text});break;case r.CompareOperators.LTE:t=i?t.filter(function(r){return a(r[e.Name],e.Filter.Text)||o(r[e.Name],e.Filter.Text)}):t.filter(function(r){return r[e.Name]<=e.Filter.Text});break;case r.CompareOperators.BETWEEN:t=i?t.filter(function(r){return(a(r[e.Name],e.Filter.Text)||n(r[e.Name],e.Filter.Text))&&(a(r[e.Name],e.Filter.Argument[0])||o(r[e.Name],e.Filter.Argument[0]))}):t.filter(function(r){return r[e.Name]>=e.Filter.Text&&r[e.Name]<=e.Filter.Argument[0]});break;default:throw new Error(\"Unsupported Compare Operator\")}}),t},e.applySorting=function(e,t){var a=e.Columns.filter(function(e){return e.SortOrder>0}),n=[{Name:e.Columns[0].Name,Asc:!0}];return a.length>0&&(a.sort(function(e,r){return e.SortOrder>r.SortOrder?1:r.SortOrder>e.SortOrder?-1:0}),n=a.map(function(e){return{Name:e.Name,Asc:e.SortDirection===r.ColumnSortDirection.ASCENDING}})),t.sort(function(e,r){for(var t=0,a=0,o=n;a<o.length;a++){var i=o[a],u=i.Asc?1:-1;if(void 0===e[i.Name]||void 0===r[i.Name]){t=-1*u;break}if(e[i.Name]<r[i.Name]){t=-1*u;break}if(e[i.Name]>r[i.Name]){t=1*u;break}}return t}),t},e.getAggregatePayload=function(e,t){return e.Columns.filter(function(e){return e.Aggregate&&e.Aggregate.toLowerCase()!==r.AggregateFunctions.NONE.toLowerCase()}).reduce(function(e,a){switch(a.Aggregate.toLowerCase()){case r.AggregateFunctions.SUM.toLowerCase():e[a.Name]=0===t.length?0:t.reduce(function(e,r){return void 0===r[a.Name]?e:e+r[a.Name]},0);break;case r.AggregateFunctions.AVERAGE.toLowerCase():e[a.Name]=0===t.length?0:t.reduce(function(e,r){return void 0===r[a.Name]?e:e+r[a.Name]},0)/t.length;break;case r.AggregateFunctions.MAX.toLowerCase():e[a.Name]=0===t.length?0:t.reduce(function(e,r){return r[a.Name]>e?r[a.Name]:e},t[0][a.Name]);break;case r.AggregateFunctions.MIN.toLowerCase():e[a.Name]=0===t.length?0:t.reduce(function(e,r){return r[a.Name]<e?r[a.Name]:e},t[0][a.Name]);break;case r.AggregateFunctions.COUNT.toLowerCase():e[a.Name]=t.length;break;case r.AggregateFunctions.DISTINCT_COUNT.toLowerCase():e[a.Name]=0===t.length?0:t.reduce(function(e,r){return-1===e.indexOf(r[a.Name])&&e.push(r[a.Name]),e},[]).length;break;default:throw new Error(\"Unsupported aggregate function\")}return e},{})},e.parsePayload=function(e,r){return r.reduce(function(r,t,a){return r[t.Name]=e[a]||e[t.Name],r},{})},e}();exports.default=i;"},"sourceMaps":null,"error":null,"hash":"c41326837404cf55c059e09fb9b66bc6","cacheData":{"env":{}}}